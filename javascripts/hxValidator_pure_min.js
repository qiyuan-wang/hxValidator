/*! hxValidator 
* v0.0.9 
* 2014-08-27
*  http://www.huxiu.com
* Copyright (c) 2014 zisasign; Licensed MIT */


!function(){function a(a){return a.replace(/^data-/,"").replace(/-\w+/g,function(a){return a.charAt(1).toUpperCase()+a.substring(2).toLowerCase()})}function b(a,b){for(var c=b.split(" "),d=0;d<c.length;d++)a.className=a.className.replace(c[d],"");a.className=a.className.replace(/^\s+|\s+$/,"")}function c(a,b){for(var c=b.split(" "),d=0;d<c.length;d++)a.className.match(c[d])||(a.className+=" "+c[d])}var d={messages:{required:"此项为必填项",minLength:"此项要求最少%s个字符长度",maxLength:"此项要求最多%s个字符长度",phone:"手机格式错误",email:"邮件格式错误",number:"此项只能输入数字",notAllNumber:"此项不能全为数字",match:"与%s输入不一致"},errorCallback:function(a){var d=a.hints.parentNode.getElementsByClassName("icon")[0];b(d,"icon-success"),c(d,"icon-error icon-inset")},successCallback:function(a){var d=a.hints.parentNode.getElementsByClassName("icon")[0];b(d,"icon-error"),c(d,"icon-success icon-inset")},focusCallback:function(a){var c=a.hints.parentNode.getElementsByClassName("icon")[0];b(c,"icon-error icon-success icon-inset")}},e=/^data(?:-[a-z]+)+$/gi,f=/^1[3-8]\d{9}$/,g=/^[0-9]+$/,h=/^[a-zA-Z0-9.!#$%&amp;'*+\-\/=?\^_`{|}~\-]+@[a-zA-Z0-9\-]+(?:\.[a-zA-Z0-9\-]{2,})+$/,i=function(a,b){function c(){var a=this.form.querySelectorAll("input"),b=[],c=0;for(c;c<a.length;c++)"submit"!==a[c].type&&"button"!==a[c].type&&b.push(a[c]);return b}function e(){for(var a,b={},c=0,d=arguments.length;d>c;c++)for(a in arguments[c])arguments[c].hasOwnProperty(a)&&(b[a]=arguments[c][a]);return b}var f=a||"hxValidator",b=b||{};this.form=document.getElementById(f),this.fields={},this.errorsClass=b.errorsClass||"errors",this.hintsClass=b.hintsClass||"hints",this.wrapperClass=b.wrapperClass||"hxValidator-field",this.messages=e({},d.messages,b.messages),this.errorCallback=b.errorCallback||d.errorCallback,this.successCallback=b.successCallback||d.successCallback,this.focusCallback=b.focusCallback||d.focusCallback,this._checkMethods=e({},this._checkMethods,b.customCheckMethods);for(var g=c.apply(this),h=0;h<g.length;h++)this._addField(g[h]);for(var i in this.fields)if(this.fields.hasOwnProperty(i)){var j=this.fields[i];j.element.addEventListener("blur",this._validateField.bind(this,j)),j.element.addEventListener("focus",this._focusField.bind(this,j))}this.form.addEventListener("submit",this._validateForm.bind(this))};i.prototype._addField=function(b){for(var c={},d=b.attributes,f=0;f<d.length;f++){var g=d[f];if(g.name.match(e)){var h=a(g.name);c[h]=g.value}}this.fields[b.attributes.name.value]={type:b.attributes.type.value,rules:c,element:b,errors:b.parentNode.getElementsByClassName(this.errorsClass)[0],hints:b.parentNode.getElementsByClassName(this.hintsClass)[0],wrapper:b.parentNode,value:null,passed:null}},i.prototype._validateField=function(a){var b=a.rules,c=null;if(a.value=a.element.value,b.required&&!this._checkMethods.required.apply(this,[a,b.required]))return a.passed=!1,void this._addError.apply(this,[a,"required"]);for(var d in b)if(b.hasOwnProperty(d)&&"required"!==d)if(d.match(/Remote$/))c=d;else{var e=b[d];if(a.passed=this._checkMethods[d].apply(this,[a,e]),!a.passed)return void this._addError(a,d,e)}if(c){var e=b[c];if(a.passed=this._checkMethods[c].apply(this,[a,e]),!a.passed)return void this._addError(a,c,e)}a.passed=!0,this._addSuccess(a)},i.prototype._validateForm=function(a){var b=!0;for(var c in this.fields)if(this.fields.hasOwnProperty(c)){var d=this.fields[c];null===d.passed&&this._validateField(d),b=b&&d.passed}return b?!0:(a.preventDefault(),!1)},i.prototype._checkMethods={required:function(a,b){return b?a.value&&""!==a.value&&void 0!==a.value:void 0},minLength:function(a,b){var c=a.value.replace(/[^\x00-\xff]/g,"***");return c.length>=b},maxLength:function(a,b){var c=a.value.replace(/[^\x00-\xff]/g,"***");return c.length<=b},phone:function(a,b){return b?f.test(a.value):void 0},email:function(a,b){return b&&0!==a.value.length&&void 0!==a.value?h.test(a.value):void 0},number:function(a,b){return b&&0!==a.value.length&&void 0!==a.value?g.test(a.value):void 0},notAllNumber:function(a,b){return b&&0!==a.value.length&&void 0!==a.value?!g.test(a.value):void 0},match:function(a,b){var c="string"==typeof b&&b.indexOf("|")>0?b.split("|")[0]:b,d=this.form[c];return d?a.value===d.value:!0}},i.prototype._focusField=function(a){var c=this;return function(){a.wrapper.className.indexOf("success")>0||(b(a.wrapper,"error"),a.hints.style.display="none",a.errors.innerHTML="",c.focusCallback&&c.focusCallback(a))}},i.prototype._addError=function(a,d,e){var f=this.messages[d];if(f.indexOf("%s")>0){var g="string"==typeof e&&e.indexOf("|")>0?e.split("|")[1]:e;f=f.replace("%s",g)}b(a.wrapper,"success"),c(a.wrapper,"error"),a.hints.style.display="none",a.errors.innerHTML=f,this.errorCallback&&this.errorCallback(a)},i.prototype._addSuccess=function(a){b(a.wrapper,"error"),c(a.wrapper,"success"),a.hints.style.display="none",a.errors.innerHTML="",this.successCallback&&this.successCallback(a)},"function"==typeof define&&define.amd&&define(function(){return{hxValidator:i}}),"undefined"!=typeof exports&&(exports.hxValidator=i),"undefined"!=typeof window&&(window.hxValidator=i)}();