/*! hxValidator 
* v0.1.1 
* 2014-09-22
*  http://www.huxiu.com
* Copyright (c) 2014 zisasign; Licensed MIT */


function smallCamelUpperCase(a){return a.replace(/^data-/,"").replace(/-\w+/g,function(a){return a.charAt(1).toUpperCase()+a.substring(2).toLowerCase()})}function removeClasses(a,b){for(var c=b.split(" "),d=0;d<c.length;d++)a.className=a.className.replace(c[d],"");a.className=a.className.replace(/^\s+|\s+$/,"")}function addClasses(a,b){for(var c=b.split(" "),d=0;d<c.length;d++)a.className.match(c[d])||(a.className+=" "+c[d])}var defaults={messages:{required:"This field is required",minLength:"This field needs %s characters at least",maxLength:"This field needs %s characters at most",phone:"Not a valid phone number",email:"Not a valid Email address",number:"Number only",notAllNumber:"Can't be all numbers",match:"Does not match the %s field"},errorCallback:function(a){var b=a.hints.parentNode.getElementsByClassName("icon")[0];removeClasses(b,"icon-success"),addClasses(b,"icon-error icon-inset")},successCallback:function(a){var b=a.hints.parentNode.getElementsByClassName("icon")[0];removeClasses(b,"icon-error"),addClasses(b,"icon-success icon-inset")},focusCallback:function(a){var b=a.hints.parentNode.getElementsByClassName("icon")[0];removeClasses(b,"icon-error icon-success icon-inset")}},dataAttrRegex=/^data(?:-[a-z]+)+$/gi,phoneRegex=/^1[3-8]\d{9}$/,numberRegex=/^[0-9]+$/,emailRegex=/^[a-zA-Z0-9.!#$%&amp;'*+\-\/=?\^_`{|}~\-]+@[a-zA-Z0-9\-]+(?:\.[a-zA-Z0-9\-]{2,})+$/,hxValidator=function(a,b){function c(){var a=this.form.querySelectorAll("input"),b=[],c=0;for(c;c<a.length;c++)"submit"!==a[c].type&&"button"!==a[c].type&&b.push(a[c]);return b}function d(){for(var a,b={},c=0,d=arguments.length;d>c;c++)for(a in arguments[c])arguments[c].hasOwnProperty(a)&&(b[a]=arguments[c][a]);return b}var e=a||"#hxValidator",b=b||{};this.form=document.querySelector(e),this.fields={},this.errorsClass=b.errorsClass||".errors",this.hintsClass=b.hintsClass||".hints",this.wrapperClass=b.wrapperClass||"hxValidator-field",this.messages=d({},defaults.messages,b.messages),this.errorCallback=b.errorCallback||defaults.errorCallback,this.successCallback=b.successCallback||defaults.successCallback,this.focusCallback=b.focusCallback||defaults.focusCallback,this._checkMethods=d({},this._checkMethods,b.customCheckMethods);for(var f=c.apply(this),g=0;g<f.length;g++)this._addField(f[g]);for(var h in this.fields)if(this.fields.hasOwnProperty(h)){var i=this.fields[h];i.element.addEventListener("blur",this._validateField.bind(this,i)),i.element.addEventListener("focus",this._focusField.bind(this,i))}this.form.addEventListener("submit",this._validateForm.bind(this)),this._hideAllHints()};hxValidator.prototype._hideAllHints=function(){var a=document.querySelectorAll(this.hintsClass);[].slice.apply(a).forEach(function(a){a.style.display="none"})},hxValidator.prototype._addField=function(a){for(var b={},c=a.attributes,d=0;d<c.length;d++){var e=c[d];if(e.name.match(dataAttrRegex)){var f=smallCamelUpperCase(e.name);b[f]=e.value}}this.fields[a.attributes.name.value]={type:a.attributes.type.value,rules:b,element:a,errors:a.parentNode.querySelector(this.errorsClass),hints:a.parentNode.querySelector(this.hintsClass),wrapper:a.parentNode,value:null,passed:null}},hxValidator.prototype._validateField=function(a){var b=a.rules,c=null;if(a.value=a.element.value,b.required&&!this._checkMethods.required.apply(this,[a,b.required]))return a.passed=!1,void this._addError.apply(this,[a,"required"]);for(var d in b)if(b.hasOwnProperty(d)&&"required"!==d)if(d.match(/Remote$/))c=d;else{var e=b[d];if(a.passed=this._checkMethods[d].apply(this,[a,e]),!a.passed)return void this._addError(a,d,e)}if(c){var e=b[c];if(a.passed=this._checkMethods[c].apply(this,[a,e]),!a.passed)return void this._addError(a,c,e)}a.passed=!0,this._addSuccess(a)},hxValidator.prototype._validateForm=function(a){var b=!0;for(var c in this.fields)if(this.fields.hasOwnProperty(c)){var d=this.fields[c];null===d.passed&&this._validateField(d),b=b&&d.passed}return b?!0:(a.preventDefault(),!1)},hxValidator.prototype._checkMethods={required:function(a,b){return b?a.value&&""!==a.value&&void 0!==a.value:void 0},minLength:function(a,b){var c=a.value.replace(/[^\x00-\xff]/g,"***");return c.length>=b},maxLength:function(a,b){var c=a.value.replace(/[^\x00-\xff]/g,"***");return c.length<=b},phone:function(a,b){return b?phoneRegex.test(a.value):void 0},email:function(a,b){return b&&0!==a.value.length&&void 0!==a.value?emailRegex.test(a.value):void 0},number:function(a,b){return b&&0!==a.value.length&&void 0!==a.value?numberRegex.test(a.value):void 0},notAllNumber:function(a,b){return b&&0!==a.value.length&&void 0!==a.value?!numberRegex.test(a.value):void 0},match:function(a,b){var c="string"==typeof b&&b.indexOf("|")>0?b.split("|")[0]:b,d=this.form[c];return d?a.value===d.value:!0}},hxValidator.prototype._focusField=function(a){a.wrapper.className.indexOf("success")>0||(removeClasses(a.wrapper,"error"),a.hints.style.display="block",a.errors.innerHTML="",this.focusCallback&&this.focusCallback(a))},hxValidator.prototype._addError=function(a,b,c){var d=this.messages[b];if(d.indexOf("%s")>0){var e="string"==typeof c&&c.indexOf("|")>0?c.split("|")[1]:c;d=d.replace("%s",e)}removeClasses(a.wrapper,"success"),addClasses(a.wrapper,"error"),a.hints.style.display="none",a.errors.innerHTML=d,this.errorCallback&&this.errorCallback(a)},hxValidator.prototype._addSuccess=function(a){removeClasses(a.wrapper,"error"),addClasses(a.wrapper,"success"),a.hints.style.display="none",a.errors.innerHTML="",this.successCallback&&this.successCallback(a)};