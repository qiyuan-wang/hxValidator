/*! hxValidator 
* v0.1.6 
* 2014-09-23
*  http://www.huxiu.com
* Copyright (c) 2014 zisasign; Licensed MIT */


var defaults={messages:{required:"This field is required",minLength:"This field needs %s characters at least",maxLength:"This field needs %s characters at most",phone:"Not a valid phone number",email:"Not a valid Email address",number:"Number only",notAllNumber:"Can't be all numbers",match:"Does not match the %s field"},errorCallback:function(a){a.element.siblings(".icon").removeClass("icon-success").addClass("icon-error icon-inset")},successCallback:function(a){a.element.siblings(".icon").removeClass("icon-error").addClass("icon-success icon-inset")},focusCallback:function(a){a.element.siblings(".icon").removeClass("icon-error icon-success icon-inset")}},phoneRegex=/^1[3-8]\d{9}$/,numberRegex=/^[0-9]+$/,emailRegex=/^[a-zA-Z0-9.!#$%&amp;'*+\-\/=?\^_`{|}~\-]+@[a-zA-Z0-9\-]+(?:\.[a-zA-Z0-9\-]{2,})+$/,hxValidator=function(a,b){var b=b||{};this.form=a instanceof $?a:$(a),this.fields={},this.errorsClass=b.errorsClass||".errors",this.hintsClass=b.hintsClass||".hints",this.wrapperClass=b.wrapperClass||".hxValidator-field",this.messages=$.extend({},defaults.messages,b.messages),this.errorCallback=b.errorCallback||defaults.errorCallback,this.successCallback=b.successCallback||defaults.successCallback,this.focusCallback=b.focusCallback||defaults.focusCallback,this._checkMethods=$.extend({},this._checkMethods,b.customCheckMethods);for(var c=this.form.find("input[type!=hidden][type!=submit]"),d=0;d<c.length;d++)this._addField(c[d]);for(var e in this.fields)if(this.fields.hasOwnProperty(e)){var f=this.fields[e];f.element.on("blur",$.proxy(this._validateField,this,f)),f.element.on("focus",$.proxy(this._focusField,this,f))}this.form.submit($.proxy(this._validateForm,this)),this._hideAllHints()};hxValidator.prototype._validateForm=function(){var a=!1;for(var b in this.fields)if(this.fields.hasOwnProperty(b)){var c=this.fields[b];null===c.failed&&this._validateField(c),a=a||c.failed}return a?!1:!0},hxValidator.prototype._addField=function(a){var b=$(a);this.fields[b.attr("name")]={rules:b.data(),type:b.attr("type"),element:b,errors:b.siblings(this.errorsClass),hints:b.siblings(this.hintsClass),wrapper:b.parent(this.wrapperClass),value:null,failed:null}},hxValidator.prototype._validateField=function(a){var b=a.rules,c=null;if(a.value=a.element.val(),b.required&&this._checkMethods.required.apply(this,[a,!0]))return a.failed=!0,void this._addError(a,"required");for(var d in b)if(b.hasOwnProperty(d)&&"required"!==d)if(d.match(/Remote$/))c=d;else{var e=b[d];if(a.failed=this._checkMethods[d].apply(this,[a,e]),a.failed)return void this._addError(a,d,e)}if(c){var e=b[c];if(a.failed=this._checkMethods[c].apply(this,[a,e]),a.failed)return void this._addError(a,c,e)}a.failed=!1,this._addSuccess(a)},hxValidator.prototype._focusField=function(a){a.wrapper.hasClass("success")||(a.wrapper.removeClass("error"),a.hints.show(),a.errors.text(""),this.focusCallback(a))},hxValidator.prototype._addSuccess=function(a){a.wrapper.removeClass("error").addClass("success"),a.hints.hide(),a.errors.text(),this.successCallback(a)},hxValidator.prototype._addError=function(a,b,c){var d=this.messages[b];if(d.indexOf("%s")>0){var e="string"==typeof c&&c.indexOf("|")>0?c.split("|")[1]:c;d=d.replace("%s",e)}a.wrapper.removeClass("success").addClass("error"),a.hints.hide(),a.errors.text(d),this.errorCallback(a)},hxValidator.prototype._hideAllHints=function(){$(".hints").hide()},hxValidator.prototype._checkMethods={required:function(a,b){return b?!a.value||""===a.value||void 0===a.value:void 0},minLength:function(a,b){var c=a.value.replace(/[^\x00-\xff]/g,"***");return c.length<b},maxLength:function(a,b){var c=a.value.replace(/[^\x00-\xff]/g,"***");return c.length>b},phone:function(a,b){return b?!phoneRegex.test(a.value):void 0},email:function(a,b){return b&&0!==a.value.length?!emailRegex.test(a.value):void 0},number:function(a,b){return b&&0!==a.value.length?!numberRegex.test(a.value):void 0},notAllNumber:function(a,b){return b&&0!==a.value.length?numberRegex.test(a.value):void 0},match:function(a,b){var c="string"==typeof b&&b.indexOf("|")>0?b.split("|")[0]:b,d=this.form[0][c];return d?a.value!==d.value:!0}};